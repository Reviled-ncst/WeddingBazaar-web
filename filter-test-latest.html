<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filter Fix v3.0 Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            line-height: 1.6;
        }
        .status { 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 5px;
        }
        .success { background-color: #d4edda; color: #155724; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        .warning { background-color: #fff3cd; color: #856404; }
        .error { background-color: #f8d7da; color: #721c24; }
        .code { 
            background-color: #f8f9fa; 
            padding: 10px; 
            border-radius: 5px; 
            font-family: monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>üîß Filter Fix v3.0 Test - Latest Deployment</h1>
    <p><strong>Time:</strong> <span id="time"></span></p>
    
    <div class="status info">
        <strong>üöÄ Test Status:</strong> Checking if Filter Fix v3.0 is deployed...
    </div>

    <div class="status info">
        <strong>üîç What we're testing:</strong>
        <ul>
            <li>‚úÖ Fixed dropdown with only valid statuses (removed quote_sent, quote_accepted)</li>
            <li>‚úÖ Enhanced debug logging with [FILTER FIX v3.0] tags</li>
            <li>‚úÖ Comprehensive status checking and filtering</li>
        </ul>
    </div>

    <h2>Test Actions:</h2>
    <button onclick="testBookingsPage()">üîç Test Bookings Page</button>
    <button onclick="testLoginAndFilter()">üë§ Login & Test Filter</button>
    <button onclick="clearCache()">üßπ Clear Cache</button>

    <h2>Expected Behavior After Fix:</h2>
    <div class="code">
Console should show:
[FILTER FIX v3.0] ===== FILTER START =====
[FILTER FIX v3.0] Status Distribution: {quote_requested: 32, confirmed: 1, downpayment_paid: 1}
[FILTER FIX v3.0] Filtering for status: confirmed
[FILTER FIX v3.0] Filtered Results: 1 out of 34
[FILTER FIX v3.0 STATE] setFilteredAndSortedBookings completed! New count: 1
[FILTER FIX v3.0 RENDER] About to render 1 bookings
    </div>

    <h2>Live Test Results:</h2>
    <div id="results"></div>

    <script>
        document.getElementById('time').textContent = new Date().toLocaleString();

        function testBookingsPage() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="status info">üîÑ Opening bookings page to test filter fix...</div>';
            
            // Open in new tab with cache busting
            const url = `https://weddingbazaar-web.web.app/individual/bookings?v=${Date.now()}`;
            window.open(url, '_blank');
            
            results.innerHTML += `
                <div class="status success">
                    ‚úÖ Opened: <a href="${url}" target="_blank">${url}</a>
                </div>
                <div class="status info">
                    <strong>Instructions:</strong>
                    <ol>
                        <li>Login with: couple1@gmail.com / any password</li>
                        <li>Open browser console (F12)</li>
                        <li>Look for [FILTER FIX v3.0] logs</li>
                        <li>Try changing the status filter dropdown</li>
                        <li>Verify bookings update correctly</li>
                    </ol>
                </div>
            `;
        }

        function testLoginAndFilter() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="status info">üîÑ Testing automated login and filter...</div>';
            
            // This would need to be implemented with proper API calls
            // For now, just provide instructions
            results.innerHTML += `
                <div class="status warning">
                    ‚ö†Ô∏è Manual test required:
                    <ol>
                        <li>Go to: <a href="https://weddingbazaar-web.web.app" target="_blank">https://weddingbazaar-web.web.app</a></li>
                        <li>Click "Login" and use: couple1@gmail.com</li>
                        <li>Go to individual bookings page</li>
                        <li>Try filter dropdown - should show only valid options</li>
                        <li>Change filter to "Confirmed" - should show 1 booking</li>
                        <li>Change filter to "Downpayment Paid" - should show 1 booking</li>
                        <li>Change filter to "Quote Requested" - should show 32 bookings</li>
                    </ol>
                </div>
            `;
        }

        function clearCache() {
            const results = document.getElementById('results');
            results.innerHTML = `
                <div class="status success">üßπ Cache clearing instructions:</div>
                <div class="code">
// In browser console:
localStorage.clear();
sessionStorage.clear();
location.reload(true);

// Or hard refresh:
Ctrl+F5 (Windows) / Cmd+Shift+R (Mac)
                </div>
            `;
        }

        // Auto-refresh every 30 seconds to show current time
        setInterval(() => {
            document.getElementById('time').textContent = new Date().toLocaleString();
        }, 30000);
    </script>
</body>
</html>
